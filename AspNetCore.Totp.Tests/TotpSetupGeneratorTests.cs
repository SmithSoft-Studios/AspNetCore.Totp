using Xunit;

namespace AspNetCore.Totp.Tests;

public class TotpSetupGeneratorTests
{
    private readonly TotpSetupGenerator totpSetupGenerator;

    public TotpSetupGeneratorTests()
    {
        totpSetupGenerator = new TotpSetupGenerator();
    }

    [Fact]
    public void GenerateSetupCode_shouldNotBeNull_manuelTest_workWithGoogleAuthenticator()
    {
        var totpSetup =
          totpSetupGenerator.Generate("Super Totp Tester", "Damir Kusar", "7FF3F52B-2BE1-41DF-80DE-04D32171F8A3");
        Assert.NotNull(totpSetup);
        Assert.Equal("G5DEMM2GGUZEELJSIJCTCLJUGFCEMLJYGBCEKLJQGRCDGMRRG4YUMOCBGM", totpSetup.ManualSetupKey);
        Assert.Equal("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAYAAAB5fY51AAAABHNCSVQICAgIfAhkiAAACXBJREFUeJzt3VFuK7kOBUBn8Pa/5cwG3PNCmJR4jKrPi0BuO86BIF5SP7+/v78vgAD/3H4AgL8SWEAMgQXEEFhADIEFxBBYQAyBBcQQWEAMgQXEEFhADIEFxBBYQAyBBcQQWEAMgQXEEFhADIEFxBBYQAyBBcQQWEAMgQXEEFhAjP9NLv7z8zO5/Ec6bjd7en+Ta3eoPF/He6y8l6d1O9aorLt9jW//23pihwXEEFhADIEFxBBYQIzRQ/d3Jg/knkwdUE4eiFbWrj5HZY3Nh77V71LlfVfWqOp4jne+6W/riR0WEENgATEEFhBDYAExBBYQ43iV8MlkZa3D1PNtqLa9XvXWkKnWnCenW2W+yfa/rQo7LCCGwAJiCCwghsACYggsIMaaKuEWlQrTlgF+p3sXq2t0mOrh20Jl82/ssIAYAguIIbCAGAILiOHQ/Y86Bue9+/ktQ9e2HGpvKWR0FCE2H/KnssMCYggsIIbAAmIILCCGwAJirKkSbmlBOD0orlpJmhoC2FHxrKiuO9Ui1PG+t7fVbHmODnZYQAyBBcQQWEAMgQXEEFhAjONVwu39Vad72TqqYk8m166sO1WlulHhm+opvVFxTmSHBcQQWEAMgQXEEFhAjJ/fb/p/+4OmDswnD2wnTbXmVF5v8n2fbtHib+ywgBgCC4ghsIAYAguIIbCAGKOtOVND1zper+M5blS6tlQrN7SBVL8zHVd0nW7R6nD673CSHRYQQ2ABMQQWEENgATEEFhBjTS9h4rCz7ZWd0/2I2yu9U9WyGz2Np6u0S2LCDgvIIbCAGAILiCGwgBhf1ZrT8RxPTh8oVw5btwyye7KhjedJx/u70RpVWePJllalCjssIIbAAmIILCCGwAJiCCwgxmiVcGpg3eRzVKo1qZXNjrUrn0fH96CyxpYr0iY//9PVOa05AEUCC4ghsIAYAguIIbCAGKMD/LZUQzquxuoY6LZlwOCG4W+TVdrTn//2AYobft9d7LCAGAILiCGwgBgCC4hx/NB9y2H3jYJAR3vPt6wx2ZrTYctQvsrak5+p1hyAIoEFxBBYQAyBBcQQWECM4wP8qqaqMh1Vsc3XV20yNTDwyeT3ILE611Gt3FI9tMMCYggsIIbAAmIILCCGwAJijFYJP70KqrLuf9k8MG2y0ni6t3J7L+dUhe/G4LzT185tYYcFxBBYQAyBBcQQWECM0QF+FVvaXCYHt532TTe/dJgaKHmjbWVLq9JpdlhADIEFxBBYQAyBBcQQWECM0dacislhf1OVj9PXOHU5PVhxyuTVcBUdwyA7XrOjzejJliq5HRYQQ2ABMQQWEENgATEEFhBjTS/hk9M9U6cH+93o4Zv6lW955i09lDcG+1VMVYtVCQFeAgsIIrCAGAILiHH80P3GjTdTQ9cmW4FuDIU7acvnv+UAvOp0e9WW750dFhBDYAExBBYQQ2ABMQQWEGN0gN+WCkzlORLbOiavJtv8O+wYnHej+tXxmZ4eArilam2HBcQQWEAMgQXEEFhADIEFxFhzzVeH0z181UrNVIXvRtXp0896svp4+rObNPmdPj0cs4MdFhBDYAExBBYQQ2ABMY4fulcPmacOlG+0ZJweRvjputW1t7RvbLm1aHKQ4Onv9JbfrR0WEENgATEEFhBDYAExBBYQY31rzlRlrWqqhWNy+N6T0++l4vT1Xx0DFG9IrLx2sMMCYggsIIbAAmIILCDG6KF75fBt88F4VccB5Y3D+IoNRYgb7VXvdLT3PJn8Tm95jgo7LCCGwAJiCCwghsACYggsIMZolXBqsNyWqsyWKlXVhraOG4MLTw8jnBwkWJFYeX1ihwXEEFhADIEFxBBYQAyBBcRYM8BvS//dk6nrtW6Yqg5t6QedrM5NXRVWVfk+dgw0rDzHJDssIIbAAmIILCCGwAJiHB/gd+OgekMryuv1/r2fbgHpWrvyelM6iiynb+l5+vmOQlJHAWE7OywghsACYggsIIbAAmIILCDGmtacyfaBv65bfY7JVqBJUwPkbgyhO/0cHa93eqDhZKX39BBAOywghsACYggsIIbAAmIILCDG8Srh5MC0SZuH3lXXnuppPF0NnKzGdlT4Jq/X6njviVfa2WEBMQQWEENgATEEFhBjTWtORcchZ9XpdoqKydtZqq95+jk+teUzOl2w6KI1B+CBwAJiCCwghsACYggsIMbxKuFkhW+yWna6KjZ5vdOnr/f081t+V0+2tNV0OD0kcstQSjssIIbAAmIILCCGwAJiCCwgxmiVcEtlYcvwvY7n+Ja+vMnKZsX2K7omdQxLPP19tMMCYggsIIbAAmIILCDGz+/gqdlUG0nV1EHpk+0HtlO/8sn3/dd1q7YUhm7YXMB5YocFxBBYQAyBBcQQWEAMgQXEGK0STtkydK2jXWFLy8OTqfe45f11mPwePDn9HdvyPbXDAmIILCCGwAJiCCwghsACYhyvEp7uGewy1fu25WqyDlsqVx22VDE7+jO3DEvsYIcFxBBYQAyBBcQQWECM47fmdNw0c+M5OnQMNDx92Fox9bt6veZuyKk+8+bvdPVnt9zeU2GHBcQQWEAMgQXEEFhADIEFxIgc4DfpdMtIR4XpRpXq06/NjaFy396qdGPt0+ywgBgCC4ghsIAYAguIIbCAGMd7CbeYrKxVqlQd1zttqQJtr7BW1pjsv9vcHzt53VgHOywghsACYggsIIbAAmKMHrq/s2Vw3o3X29IKsfkQvMPUcLuu5+g4uN/8WU8+mx0WEENgATEEFhBDYAExBBYQ43iV8MmGoXJdazy9l6lqZeoQwHdutNtUfnZLu9OULd+DJ3ZYQAyBBcQQWEAMgQXEEFhAjDVVwu0qlbVKlaqjKnOjovVpP+KNwXmnhx9OXjfW8Xm8U/08DPADeCCwgBgCC4ghsIAYDt0/sKV948YBdsWWm2bemWxF6fj8Jw/uK7Z81+2wgBgCC4ghsIAYAguIIbCAGGuqhJuvLbrxeh1XcVXWmBwCONWaU3m26s+ebkWprnu60rjl79MOC4ghsIAYAguIIbCAGAILiHG8Sni6CtfldP9dxelBcU//frp3cbI6umWQ4Kfrdj2HXkKAIoEFxBBYQAyBBcT4+d3yf+4B/g87LCCGwAJiCCwghsACYggsIIbAAmIILCCGwAJiCCwghsACYggsIIbAAmIILCCGwAJiCCwghsACYggsIIbAAmIILCCGwAJiCCwghsACYvwLTgOR18JTPD4AAAAASUVORK5CYII=", totpSetup.QrCodeImage);
    }
}